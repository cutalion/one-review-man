{% assign current_chapter = page.chapter_number %}
{% assign chapters = site.chapters | sort: "chapter_number" %}

{% assign prev_chapter = nil %}
{% assign next_chapter = nil %}

{% for chapter in chapters %}
  {% if chapter.chapter_number < current_chapter %}
    {% assign prev_chapter = chapter %}
  {% elsif chapter.chapter_number > current_chapter and next_chapter == nil %}
    {% assign next_chapter = chapter %}
  {% endif %}
{% endfor %}

<div class="chapter-nav">
  <div class="nav-links">
    {% if prev_chapter %}
      <a href="{{ prev_chapter.url }}" class="nav-link prev-chapter">
        <span class="nav-label">← Previous</span>
        <span class="nav-title">{{ prev_chapter.title }}</span>
      </a>
    {% endif %}
    
    <a href="/chapters" class="nav-link chapters-index">
      <span class="nav-label">All Chapters</span>
    </a>
    
    {% if next_chapter %}
      <a href="{{ next_chapter.url }}" class="nav-link next-chapter">
        <span class="nav-label">Next →</span>
        <span class="nav-title">{{ next_chapter.title }}</span>
      </a>
    {% endif %}
  </div>
  
  <div class="chapter-progress">
    <div class="progress-text">
      Chapter {{ current_chapter }} of {{ chapters.size }}
    </div>
    <div class="progress-bar">
      <div class="progress-fill" style="width: {{ current_chapter | times: 100 | divided_by: chapters.size }}%"></div>
    </div>
  </div>
</div>

<style>
.chapter-nav {
  background-color: #f8f9fa;
  padding: 1.5rem;
  border-radius: 8px;
  margin-top: 2rem;
}

.nav-links {
  display: grid;
  grid-template-columns: 1fr auto 1fr;
  gap: 1rem;
  align-items: center;
  margin-bottom: 1rem;
}

.nav-link {
  text-decoration: none;
  padding: 0.75rem 1rem;
  border-radius: 6px;
  background-color: white;
  border: 1px solid #e1e5e9;
  transition: all 0.2s ease;
  text-align: center;
}

.nav-link:hover {
  background-color: #3498db;
  color: white;
  border-color: #3498db;
}

.prev-chapter {
  text-align: left;
}

.next-chapter {
  text-align: right;
}

.chapters-index {
  background-color: #3498db;
  color: white;
  border-color: #3498db;
  font-weight: bold;
}

.chapters-index:hover {
  background-color: #2980b9;
}

.nav-label {
  display: block;
  font-size: 0.9rem;
  font-weight: bold;
}

.nav-title {
  display: block;
  font-size: 0.8rem;
  color: #7f8c8d;
  margin-top: 0.2rem;
}

.nav-link:hover .nav-title {
  color: rgba(255, 255, 255, 0.8);
}

.chapter-progress {
  text-align: center;
}

.progress-text {
  font-size: 0.9rem;
  color: #7f8c8d;
  margin-bottom: 0.5rem;
}

.progress-bar {
  width: 100%;
  height: 6px;
  background-color: #e1e5e9;
  border-radius: 3px;
  overflow: hidden;
}

.progress-fill {
  height: 100%;
  background-color: #3498db;
  transition: width 0.3s ease;
}

@media (max-width: 768px) {
  .nav-links {
    grid-template-columns: 1fr;
    text-align: center;
  }
  
  .prev-chapter, .next-chapter {
    text-align: center;
  }
}
</style> 
